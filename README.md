# bayesian-PValue-Prediction-Intervals
This repository provides a friendly way of computing the P-value Prediction Interval for future P-values given an observed P-value according to the article, "Assessment of P-value variability in the current replicability crisis" (https://arxiv.org/abs/1609.01664; Authors: Olga A. Vsevolozhskaya, Gabriel Ruiz, Dmitri V. Zaykin).

There are two sub-directories in this repository. The first, `/demo`, has a script, `computeInterval.R`, to compute the Bayesian P-Interval for a p-value belonging to a test statistic following the standard normal or student's t-distribution with degrees of freedom specified by the user. The prior mean on these two tests statistics $\frac{\sqrt{N}\mu}{\sigma}$ (where $\mu$ is the true mean and $\sigma$ is the true standard deviation of the iid data) follows a discretized normal distribution according to the user's specified mean and variance.

The second sub-directory, `/dkjf`, allows for a p-value belonging to a test statistic following any of the standard normal, student's t-distribution, Chi-Square Distribution, or F-distribution where the user specifies the degrees of freedom if applicable. Unlike in `/demo`, the user here is free to specify any **discrete** prior distribution on the true mean of the test statistics in the excel spreadsheet `manualPrior.xlsx` (or any other file so long as the file name is changed in `computerInterval2.R`). As before, `computerInterval2.R` provides a way of computing the Bayesian P-Interval and specifying key information to do so. Compared to `/demo/computeInterval.R`, `/dkjf/computeInterval2.R` should be used when something other than a normal prior is required for the case of the Z-test or t-test or when the p-value comes from a Chi-Square test or F-test. 

For detailed usage information, please look through the `README` files in each directory. Should you have any questions or problems with the code and method provided, please feel free to create an issue in this repository or contact the corresponding author of the article, Dmitri Zaykin, at `dmitri.zaykin@nih.gov`. We happily welcome anyone who wishes to contribute to the repository. 
